<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Test</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      color: #fff;
      background: linear-gradient(135deg, #0f0f0f, #1c1c1c);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
    }

    @keyframes gradientBG {
      0% {background-position: 0% 50%;}
      50% {background-position: 100% 50%;}
      100% {background-position: 0% 50%;}
    }

    .container {
      max-width: 800px;
      margin: auto;
      padding: 40px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      margin-top: 50px;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
    }

    h2 {
      text-align: center;
    }

    label, input {
      display: block;
      width: 100%;
      margin-bottom: 15px;
      font-size: 16px;
    }

    input {
      padding: 10px;
      border-radius: 8px;
      border: none;
      outline: none;
      background: #333;
      color: #fff;
    }

    .error {
      color: #ff4d4d;
      margin-bottom: 10px;
      display: none;
    }

    #paragraph {
      background: #222;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      font-size: 16px;
      line-height: 1.6;
    }

    textarea {
      width: 100%;
      height: 150px;
      font-size: 16px;
      padding: 10px;
      border-radius: 10px;
      background: #333;
      color: white;
      border: none;
      resize: none;
      outline: none;
    }

    button {
      background: #00b894;
      border: none;
      padding: 12px 20px;
      color: white;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
    }

    .timer {
      text-align: right;
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 20px;
    }

    .results {
      background: #2d3436;
      padding: 20px;
      border-radius: 10px;
      margin-top: 20px;
    }

    .results p {
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>ðŸ–‹ Typing Speed Test</h2>

    <div id="user-info">
      <label for="name">Name <span style="color:red">*</span></label>
      <input type="text" id="name" placeholder="Enter your name">
      <div id="nameError" class="error">Please enter a valid name (letters only).</div>

      <label for="email">Email <span style="color:red">*</span></label>
      <input type="email" id="email" placeholder="Enter your email">
      <div id="emailError" class="error">Please enter a valid email address.</div>

      <button onclick="startTyping()">Start Test</button>
    </div>

    <div id="test-area" style="display:none;">
      <div class="timer" id="timer">1:00</div>
      <div id="paragraph"></div>
      <textarea id="typing-box" disabled placeholder="Start typing here..."></textarea>
    </div>

    <div class="results" id="results" style="display:none;"></div>
  </div>

  <script>
    const paragraphs = [
      `The future belongs to those who believe in the beauty of their dreams. Never let fear hold you back, and never underestimate your potential. With effort, consistency, and belief, you can achieve more than you imagine. Each day is a chance to improve, grow, and get closer to your goals. Never settle.`,
      `Technology is evolving every second, and those who stay ahead of the curve are the ones who shape the future. Stay curious, keep building your skills, and don't be afraid to make mistakes. Every failure teaches a new lesson. Success is nothing but a stack of failures you stood on.`,
      `Life is a journey of continuous learning. The more you seek, the more you grow. Stay humble, ask questions, read often, and share knowledge. Helping others along your path multiplies your own understanding. A growing mind is never alone.`,
      `Discipline, focus, and consistency are more powerful than bursts of motivation. Don't wait for the right momentâ€”create it. Your habits define your identity, and small steps daily lead to massive results. Donâ€™t stop until you're proud.`,
      `In the world of innovation, your ability to adapt is your superpower. Ideas may be abundant, but execution is rare. Show up, iterate, and push through discomfort. Success loves speed, but mastery loves patience. Embrace both.`,
      `The real strength lies not in perfection but in progress. Comparison is the thief of joyâ€”focus on being better than yesterday. Celebrate small wins, build momentum, and keep moving forward no matter what challenges appear.`,
      `Great minds are not bornâ€”they are built through dedication, perseverance, and reflection. Every expert was once a beginner who refused to quit. Stay the course, trust the process, and let your journey be your strength.`,
      `Knowledge is power, but applied knowledge is freedom. Don't just learnâ€”implement. The real magic happens outside your comfort zone. Stretch your limits and youâ€™ll stretch whatâ€™s possible.`,
      `Creativity comes when you're not afraid to be wrong. Donâ€™t seek approvalâ€”seek expression. The most unique ideas are often the most misunderstood. Believe in your vision and let your work speak.`,
      `Success is not about how fast you go, but how steady you stay. When you're tired, learn to rest, not quit. Every effort counts and consistency compounds over time. Youâ€™re closer than you think.`
    ];

    let currentParaIndex = 0;
    let timer;
    let timeLeft = 60;
    let startTime;

    function startTyping() {
      const name = document.getElementById("name").value.trim();
      const email = document.getElementById("email").value.trim();
      const nameRegex = /^[a-zA-Z ]+$/;
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

      let valid = true;

      if (!nameRegex.test(name)) {
        document.getElementById("nameError").style.display = "block";
        valid = false;
      } else {
        document.getElementById("nameError").style.display = "none";
      }

      if (!emailRegex.test(email)) {
        document.getElementById("emailError").style.display = "block";
        valid = false;
      } else {
        document.getElementById("emailError").style.display = "none";
      }

      if (!valid) return;

      // Start typing test
      document.getElementById("user-info").style.display = "none";
      document.getElementById("test-area").style.display = "block";
      document.getElementById("typing-box").disabled = false;
      document.getElementById("typing-box").value = "";
      document.getElementById("paragraph").innerText = paragraphs[currentParaIndex];
      startTime = new Date();
      timeLeft = 60;
      updateTimer();
      timer = setInterval(updateTimer, 1000);
    }

    function updateTimer() {
      const timerDisplay = document.getElementById("timer");
      const minutes = Math.floor(timeLeft / 60);
      const seconds = timeLeft % 60;
      timerDisplay.innerText = `${minutes}:${seconds.toString().padStart(2, '0')}`;

      if (timeLeft === 0) {
        clearInterval(timer);
        finishTest();
      }
      timeLeft--;
    }

    function finishTest() {
      const typedText = document.getElementById("typing-box").value.trim();
      const originalText = paragraphs[currentParaIndex];
      const typedWords = typedText.split(/\s+/);
      const originalWords = originalText.split(/\s+/);

      let correct = 0;
      typedWords.forEach((word, i) => {
        if (word === originalWords[i]) correct++;
      });

      const timeTaken = 60;
      const wpm = Math.round((typedWords.length / timeTaken) * 60);
      const accuracy = ((correct / originalWords.length) * 100).toFixed(2);

      // Send data to Google Sheet
      fetch('https://script.google.com/macros/s/https://script.google.com/macros/s/AKfycbymSTZefAFw5DJF-ewZ2S7KkBL15uoan_m2GzoGoNdtJkq17GwnA3tJasYr1n1sPPBg/exec/exec', {
        method: 'POST',
        body: JSON.stringify({
          name: document.getElementById("name").value,
          email: document.getElementById("email").value,
          wpm: wpm,
          accuracy: accuracy,
          totalWords: typedWords.length,
          correctWords: correct,
          paraNo: currentParaIndex + 1
        }),
        headers: {
          'Content-Type': 'application/json'
        }
      })
      .then(res => res.text())
      .then(res => console.log("Google Sheet Response:", res))
      .catch(err => console.error("Error sending to Sheet:", err));

      document.getElementById("typing-box").disabled = true;
      const resultBox = document.getElementById("results");
      resultBox.innerHTML = `
        <h3>Test Result</h3>
        <p><strong>WPM:</strong> ${wpm}</p>
        <p><strong>Accuracy:</strong> ${accuracy}%</p>
        <p><strong>Total Words Typed:</strong> ${typedWords.length}</p>
        <p><strong>Correct Words:</strong> ${correct}</p>
        <p><strong>Paragraph:</strong> ${currentParaIndex + 1}/10</p>
        <p><strong>User:</strong> ${document.getElementById("name").value} (${document.getElementById("email").value})</p>
      `;
      resultBox.style.display = 'block';

      // prepare for next user
      currentParaIndex = (currentParaIndex + 1) % paragraphs.length;
      document.getElementById("user-info").style.display = "block";
      document.getElementById("test-area").style.display = "none";
      document.getElementById("name").value = "";
      document.getElementById("email").value = "";
    }
  </script>
</body>
</html>
